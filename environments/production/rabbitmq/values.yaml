# RabbitMQ Production Configuration

# Allow legacy bitnami images
global:
  security:
    allowInsecureImages: true

# Authentication - using existing sealed secret
auth:
  username: "akxr"
  existingPasswordSecret: rabbitmq-secret
  existingSecretPasswordKey: rabbitmq-password
  existingErlangSecret: rabbitmq-secret
  existingSecretErlangKey: rabbitmq-erlang-cookie

# Architecture - standalone for production
replicaCount: 1

# Image configuration
# NOTE: Using bitnamilegacy as bitnami deprecated free images
image:
  registry: docker.io
  repository: bitnamilegacy/rabbitmq
  tag: 4.0.5-debian-12-r2
  pullPolicy: IfNotPresent

# Clustering - disabled for standalone
clustering:
  enabled: false

# Resource limits and requests
resources:
  limits:
    cpu: 1000m
    memory: 2Gi
  requests:
    cpu: 250m
    memory: 512Mi

# Persistence configuration
persistence:
  enabled: true
  storageClass: "longhorn"
  accessModes:
    - ReadWriteOnce
  size: 5Gi

# Service configuration
service:
  type: ClusterIP
  ports:
    amqp: 5672
    amqpTls: 5671
    dist: 25672
    manager: 15672
    metrics: 9419
    epmd: 4369

# Node selector for production nodes
nodeSelector:
  node-type: prod

# Tolerations for production node taints
tolerations:
  - key: node
    operator: Equal
    value: prod
    effect: NoSchedule

# Network policy
networkPolicy:
  enabled: true
  allowExternal: true
  allowExternalEgress: true

# Pod disruption budget
pdb:
  create: true
  minAvailable: 1
  maxUnavailable: ""

# Metrics and monitoring (optional)
metrics:
  enabled: false

