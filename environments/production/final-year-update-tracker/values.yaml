# Daily Updates Bot CronJob Configuration

# CronJob schedule - 4 times daily at 20:00, 21:00, 22:00, 23:00 IST (8pm, 9pm, 10pm, 11pm)
schedule: "0 20,21,22,23 * * *"
timeZone: "Asia/Kolkata"

# Job history limits
successfulJobsHistoryLimit: 1
failedJobsHistoryLimit: 1

# Image configuration
image:
  repository: registry.pixr.in/final-year-update-tracker
  tag: "9cf3e52"
  pullPolicy: IfNotPresent

# Image pull secrets for private registry authentication
imagePullSecrets:
  - name: registry-pull-secret

workingDir: /app

# Environment variables loaded from secret
env:
  - name: ZULIP_SITE
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: ZULIP_SITE
  - name: ZULIP_EMAIL
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: ZULIP_EMAIL
  - name: ZULIP_API_KEY
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: ZULIP_API_KEY
  - name: ZULIP_CHANNEL
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: ZULIP_CHANNEL
  - name: ZULIP_TOPIC
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: ZULIP_TOPIC
  - name: GSHEET_ID
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: GSHEET_ID
  - name: GOOGLE_CREDS
    valueFrom:
      secretKeyRef:
        name: update-tracker-config
        key: GOOGLE_CREDS

# Resource limits
resources:
  limits:
    cpu: 200m
    memory: 128Mi
  requests:
    cpu: 100m
    memory: 64Mi

# Restart policy
restartPolicy: OnFailure

# Pod labels
podLabels:
  app: update-tracker

# Node selector for production nodes
nodeSelector:
  node-type: prod

# Tolerations for production node taints
tolerations:
  - key: node
    operator: Equal
    value: prod
    effect: NoSchedule

